const { expect: playwrightExpect } = require('@playwright/test');

// Verifica se o objeto é um Locator do Playwright
function isLocator(obj) {
  return obj && typeof obj.evaluate === 'function';
}

const expect = (locator) => {
  if (isLocator(locator)) {
    // Se for um Locator, usa diretamente o expect nativo do Playwright
    return playwrightExpect(locator);
  }

  // Se não for um Locator, continue com o comportamento customizado
  return new Proxy({}, {
    get: (target, prop) => {
      if (prop === 'not') {
        return new Proxy({}, {
          get: (target, method) => {
            return async (...args) => {
              await playwrightExpect(locator).not[method](...args);
            };
          }
        });
      }

      return async (...args) => {
        await playwrightExpect(locator)[prop](...args);
      };
    }
  });
};

// Exemplo de uso
async function toBeAttached() {
  const locator = page.locator('input[name=AGN]');
  await expect(locator).toBeAttached();  // Funciona corretamente agora
}
